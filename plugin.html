<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.41">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="https://chengpeiquan.com/favicon.ico"><meta name="keywords" content="vue 3, vue 3.x, vue 3 入门, vue 3 教程, 学习 vue 3, vue 3 案例, vue 3 教学, vue 3 好用吗"><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="#3eaf7c"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png"><link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c"><meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png"><meta name="msapplication-TileColor" content="#000000"><title>插件的使用 | Vue3 入门指南与实战案例</title><meta name="description" content="这是一个关于 Vue 3 + TypeScript 的起步学习教程，适合完全的Vue新手和Vue 2.0的老手，在官方文档的基础上融入自己的一些实践经验。">
    <link rel="modulepreload" href="/assets/app.0c7b3152.js"><link rel="modulepreload" href="/assets/plugin.html.eb66815b.js"><link rel="modulepreload" href="/assets/plugin.html.e84e0166.js"><link rel="prefetch" href="/assets/index.html.2f003589.js"><link rel="prefetch" href="/assets/communication.html.be61d0ec.js"><link rel="prefetch" href="/assets/component.html.3d44d9c3.js"><link rel="prefetch" href="/assets/efficient.html.a26166bb.js"><link rel="prefetch" href="/assets/guide.html.adff52ae.js"><link rel="prefetch" href="/assets/links.html.b094a747.js"><link rel="prefetch" href="/assets/pinia.html.7109bbd7.js"><link rel="prefetch" href="/assets/router.html.86285e99.js"><link rel="prefetch" href="/assets/update.html.e870f97c.js"><link rel="prefetch" href="/assets/404.html.9b42cd8b.js"><link rel="prefetch" href="/assets/index.html.5f058d06.js"><link rel="prefetch" href="/assets/communication.html.19f6b2f7.js"><link rel="prefetch" href="/assets/component.html.f5307f9d.js"><link rel="prefetch" href="/assets/efficient.html.ad1f20a6.js"><link rel="prefetch" href="/assets/guide.html.90f201ac.js"><link rel="prefetch" href="/assets/links.html.62996d14.js"><link rel="prefetch" href="/assets/pinia.html.642f88d2.js"><link rel="prefetch" href="/assets/router.html.60990ba2.js"><link rel="prefetch" href="/assets/update.html.100e2c95.js"><link rel="prefetch" href="/assets/404.html.4675e898.js"><link rel="prefetch" href="/assets/404.d3026537.js"><link rel="prefetch" href="/assets/Layout.527176c4.js"><link rel="prefetch" href="/assets/GitalkComment.3ff1abe3.js"><link rel="prefetch" href="/assets/GoogleAdsense.40b4bcba.js"><link rel="prefetch" href="/assets/ImgWrap.abf53801.js">
    <link rel="stylesheet" href="/assets/style.515263ec.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><img class="logo" src="https://vue3.chengpeiquan.com/assets/img/vue3.png" alt="Vue3 入门指南与实战案例"><span class="site-name can-hide">Vue3 入门指南与实战案例</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a class="external-link" href="https://chengpeiquan.com/" rel="noopener noreferrer" target="_blank" aria-label="博客首页"><!--[--><!--]--> 博客首页 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/chengpeiquan/cooking-cookbook" rel="noopener noreferrer" target="_blank" aria-label="菜谱教程"><!--[--><!--]--> 菜谱教程 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/chengpeiquan/learning-vue3" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><div id="docsearch-container"></div></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a class="external-link" href="https://chengpeiquan.com/" rel="noopener noreferrer" target="_blank" aria-label="博客首页"><!--[--><!--]--> 博客首页 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/chengpeiquan/cooking-cookbook" rel="noopener noreferrer" target="_blank" aria-label="菜谱教程"><!--[--><!--]--> 菜谱教程 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/chengpeiquan/learning-vue3" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><a href="/" class="sidebar-item sidebar-heading" aria-label="前言"><!--[--><!--]--> 前言 <!--[--><!--]--></a><!----></li><li><a href="/guide.html" class="sidebar-item sidebar-heading" aria-label="起步准备"><!--[--><!--]--> 起步准备 <!--[--><!--]--></a><!----></li><li><a href="/update.html" class="sidebar-item sidebar-heading" aria-label="升级与配置"><!--[--><!--]--> 升级与配置 <!--[--><!--]--></a><!----></li><li><a href="/component.html" class="sidebar-item sidebar-heading" aria-label="单组件的编写"><!--[--><!--]--> 单组件的编写 <!--[--><!--]--></a><!----></li><li><a href="/router.html" class="sidebar-item sidebar-heading" aria-label="路由的使用"><!--[--><!--]--> 路由的使用 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/plugin.html" class="router-link-active router-link-exact-active router-link-active sidebar-item sidebar-heading active" aria-label="插件的使用"><!--[--><!--]--> 插件的使用 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/plugin.html#关于插件" class="router-link-active router-link-exact-active sidebar-item" aria-label="关于插件"><!--[--><!--]--> 关于插件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/plugin.html#插件的安装和引入" class="router-link-active router-link-exact-active sidebar-item" aria-label="插件的安装和引入"><!--[--><!--]--> 插件的安装和引入 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/plugin.html#通过-npm-安装" class="router-link-active router-link-exact-active sidebar-item" aria-label="通过 npm 安装"><!--[--><!--]--> 通过 npm 安装 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/plugin.html#通过-cnpm-安装" class="router-link-active router-link-exact-active sidebar-item" aria-label="通过 cnpm 安装"><!--[--><!--]--> 通过 cnpm 安装 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/plugin.html#通过-yarn-安装" class="router-link-active router-link-exact-active sidebar-item" aria-label="通过 yarn 安装"><!--[--><!--]--> 通过 yarn 安装 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/plugin.html#通过-pnpm-安装" class="router-link-active router-link-exact-active sidebar-item" aria-label="通过 pnpm 安装"><!--[--><!--]--> 通过 pnpm 安装 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/plugin.html#通过-cdn-安装" class="router-link-active router-link-exact-active sidebar-item" aria-label="通过 CDN 安装"><!--[--><!--]--> 通过 CDN 安装 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/plugin.html#插件的引入" class="router-link-active router-link-exact-active sidebar-item" aria-label="插件的引入"><!--[--><!--]--> 插件的引入 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/plugin.html#vue-专属插件" class="router-link-active router-link-exact-active sidebar-item" aria-label="Vue 专属插件"><!--[--><!--]--> Vue 专属插件 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/plugin.html#全局插件的使用-new" class="router-link-active router-link-exact-active sidebar-item" aria-label="全局插件的使用{new}"><!--[--><!--]--> 全局插件的使用{new} <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/plugin.html#单组件插件的使用-new" class="router-link-active router-link-exact-active sidebar-item" aria-label="单组件插件的使用{new}"><!--[--><!--]--> 单组件插件的使用{new} <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/plugin.html#通用-js-ts-插件" class="router-link-active router-link-exact-active sidebar-item" aria-label="通用 JS / TS 插件"><!--[--><!--]--> 通用 JS / TS 插件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/plugin.html#本地插件-new" class="router-link-active router-link-exact-active sidebar-item" aria-label="本地插件{new}"><!--[--><!--]--> 本地插件{new} <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/plugin.html#封装的目的" class="router-link-active router-link-exact-active sidebar-item" aria-label="封装的目的"><!--[--><!--]--> 封装的目的 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/plugin.html#常用的封装类型" class="router-link-active router-link-exact-active sidebar-item" aria-label="常用的封装类型"><!--[--><!--]--> 常用的封装类型 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/plugin.html#开发本地通用-js-ts-插件" class="router-link-active router-link-exact-active sidebar-item" aria-label="开发本地通用 JS / TS 插件"><!--[--><!--]--> 开发本地通用 JS / TS 插件 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/plugin.html#项目结构" class="router-link-active router-link-exact-active sidebar-item" aria-label="项目结构"><!--[--><!--]--> 项目结构 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/plugin.html#设计规范与开发案例" class="router-link-active router-link-exact-active sidebar-item" aria-label="设计规范与开发案例"><!--[--><!--]--> 设计规范与开发案例 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/plugin.html#只有一个默认功能" class="router-link-active router-link-exact-active sidebar-item" aria-label="只有一个默认功能"><!--[--><!--]--> 只有一个默认功能 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/plugin.html#是一个小工具合集" class="router-link-active router-link-exact-active sidebar-item" aria-label="是一个小工具合集"><!--[--><!--]--> 是一个小工具合集 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/plugin.html#包含工具及辅助函数" class="router-link-active router-link-exact-active sidebar-item" aria-label="包含工具及辅助函数"><!--[--><!--]--> 包含工具及辅助函数 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/plugin.html#开发本地-vue-专属插件" class="router-link-active router-link-exact-active sidebar-item" aria-label="开发本地 Vue 专属插件"><!--[--><!--]--> 开发本地 Vue 专属插件 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/plugin.html#项目结构-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="项目结构"><!--[--><!--]--> 项目结构 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/plugin.html#设计规范" class="router-link-active router-link-exact-active sidebar-item" aria-label="设计规范"><!--[--><!--]--> 设计规范 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/plugin.html#开发案例" class="router-link-active router-link-exact-active sidebar-item" aria-label="开发案例"><!--[--><!--]--> 开发案例 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/plugin.html#基本结构" class="router-link-active router-link-exact-active sidebar-item" aria-label="基本结构"><!--[--><!--]--> 基本结构 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/plugin.html#编写插件" class="router-link-active router-link-exact-active sidebar-item" aria-label="编写插件"><!--[--><!--]--> 编写插件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/plugin.html#启用插件" class="router-link-active router-link-exact-active sidebar-item" aria-label="启用插件"><!--[--><!--]--> 启用插件 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/plugin.html#使用插件" class="router-link-active router-link-exact-active sidebar-item" aria-label="使用插件"><!--[--><!--]--> 使用插件 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/plugin.html#全局-api-挂载" class="router-link-active router-link-exact-active sidebar-item" aria-label="全局 API 挂载"><!--[--><!--]--> 全局 API 挂载 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/plugin.html#回顾-vue-2" class="router-link-active router-link-exact-active sidebar-item" aria-label="回顾 Vue 2"><!--[--><!--]--> 回顾 Vue 2 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/plugin.html#了解-vue-3-new" class="router-link-active router-link-exact-active sidebar-item" aria-label="了解 Vue 3{new}"><!--[--><!--]--> 了解 Vue 3{new} <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/plugin.html#定义全局-api-new" class="router-link-active router-link-exact-active sidebar-item" aria-label="定义全局 API{new}"><!--[--><!--]--> 定义全局 API{new} <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/plugin.html#使用全局-api-new" class="router-link-active router-link-exact-active sidebar-item" aria-label="使用全局 API{new}"><!--[--><!--]--> 使用全局 API{new} <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/plugin.html#全局-api-的替代方案" class="router-link-active router-link-exact-active sidebar-item" aria-label="全局 API 的替代方案"><!--[--><!--]--> 全局 API 的替代方案 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/plugin.html#本章结语" class="router-link-active router-link-exact-active sidebar-item" aria-label="本章结语"><!--[--><!--]--> 本章结语 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a href="/communication.html" class="sidebar-item sidebar-heading" aria-label="组件之间的通信"><!--[--><!--]--> 组件之间的通信 <!--[--><!--]--></a><!----></li><li><a href="/pinia.html" class="sidebar-item sidebar-heading" aria-label="全局状态的管理"><!--[--><!--]--> 全局状态的管理 <!--[--><!--]--></a><!----></li><li><a href="/efficient.html" class="sidebar-item sidebar-heading" aria-label="高效开发"><!--[--><!--]--> 高效开发 <!--[--><!--]--></a><!----></li><li><a href="/links.html" class="sidebar-item sidebar-heading" aria-label="拓展阅读"><!--[--><!--]--> 拓展阅读 <!--[--><!--]--></a><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="插件的使用" tabindex="-1"><a class="header-anchor" href="#插件的使用" aria-hidden="true">#</a> 插件的使用</h1><p>在构建 Vue 项目的过程中，离不开各种开箱即用的插件支持，用以快速完成需求，避免自己造轮子。</p><h2 id="关于插件" tabindex="-1"><a class="header-anchor" href="#关于插件" aria-hidden="true">#</a> 关于插件</h2><p>关于插件的定义，摘选一段 <a href="https://v3.vuejs.org/guide/plugins.html" target="_blank" rel="noopener noreferrer">官方plugins文档<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 的描述：</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>插件是自包含的代码，通常向 Vue 添加全局级功能。它可以是一个带有公开 <code>install()</code> 方法的 <code>object</code>，也可以是 一个<code>function</code></p><p>插件的功能范围没有严格的限制，一般有下面几种：</p><p>添加全局方法或者 <code>property</code>。如：<a href="https://github.com/karol-f/vue-custom-element" target="_blank" rel="noopener noreferrer">vue-custom-element<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>添加全局资源：指令/过滤器/过渡等，例如：<a href="https://github.com/vuejs/vue-touch" target="_blank" rel="noopener noreferrer">vue-touch<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>通过全局混入来添加一些组件选项，例如：<a href="https://github.com/vuejs/vue-router" target="_blank" rel="noopener noreferrer">vue-router<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>添加全局实例方法，通过把它们添加到 <code>config.globalProperties</code> 上实现。</p><p>一个库，提供自己的 API，同时提供上面提到的一个或多个功能。如 <a href="https://github.com/vuejs/vue-router" target="_blank" rel="noopener noreferrer">vue-router<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></div><p>不同的实现方法，也会有不同的使用方式，下面按照使用方式的不同，把插件按照三类划分，单独讲解他们之间的区别和如何使用。</p><h2 id="插件的安装和引入" tabindex="-1"><a class="header-anchor" href="#插件的安装和引入" aria-hidden="true">#</a> 插件的安装和引入</h2><p>在 <a href="/guide.html#%E4%BA%86%E8%A7%A3%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96" class="">前端工程化</a> 十分普及的今天，可以说几乎所有你要用到的插件，都可以在 <a href="https://www.npmjs.com/" target="_blank" rel="noopener noreferrer">npmjs<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 上搜到，除了官方提供的包管理器 npm ，我们也有很多种安装方式选择。</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>如果还不了解什么是包和包管理器，请先阅读 <a href="/guide.html#%E4%BA%86%E8%A7%A3%E5%8C%85%E5%92%8C%E6%8F%92%E4%BB%B6" class="">了解包和插件</a> 一节的内容。</p><p>另外，每个包管理都可以配置镜像源，提升国内的下载速度，对此也可以先阅读 <a href="/guide.html#%E9%85%8D%E7%BD%AE%E9%95%9C%E5%83%8F%E6%BA%90" class="">配置镜像源</a> 一节了解。</p></div><p>虽然对于个人开发者来说，有一个用的顺手的包管理器就足够日常开发了，但是还是有必要多了解一下不同的包管理器，因为未来可能会面对团队协作开发、为开源项目贡献代码等情况，需要遵循团队要求的包管理机制（例如使用 Monorepo 架构的团队会更青睐于 yarn 或 pnpm 的 Workspace 功能）。</p><h3 id="通过-npm-安装" tabindex="-1"><a class="header-anchor" href="#通过-npm-安装" aria-hidden="true">#</a> 通过 npm 安装</h3><p><a href="https://github.com/npm/cli" target="_blank" rel="noopener noreferrer">npm<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 是 Node.js 自带的包管理器，平时我们通过 <code>npm install</code> 命令来安装各种 npm 包（比如 <code>npm install vue-router</code> ），就是通过这个包管理器来安装的。</p><p>如果包的下载速度太慢，可以通过以下命令管理镜像源：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 查看下载源</span>
<span class="token function">npm</span> config get registry

<span class="token comment"># 绑定下载源</span>
<span class="token function">npm</span> config <span class="token builtin class-name">set</span> registry https://registry.npmmirror.com

<span class="token comment"># 删除下载源</span>
<span class="token function">npm</span> config <span class="token function">rm</span> registry
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>npm 的 lock 文件是 <code>package-lock.json</code> ，如果你有管理多人协作仓库的需求，可以根据实际情况把它添加至 <code>.gitignore</code> 文件，便于统一团队的包管理。</p></div><h3 id="通过-cnpm-安装" tabindex="-1"><a class="header-anchor" href="#通过-cnpm-安装" aria-hidden="true">#</a> 通过 cnpm 安装</h3><p><a href="https://github.com/cnpm/cnpm" target="_blank" rel="noopener noreferrer">cnpm<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 是阿里巴巴推出的包管理工具，安装之后默认会使用 <code>https://registry.npmmirror.com</code> 这个镜像源。</p><p>它的安装命令和 npm 非常一致，通过 <code>cnpm install</code> 命令来安装（比如 <code>cnpm install vue-router</code>）。</p><p>在使用它之前，你需要通过 npm 命令进行全局安装：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> -g cnpm

<span class="token comment"># 或者</span>
<span class="token comment"># npm install -g cnpm --registry=https://registry.npmmirror.com</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>cnpm 不生成 lock 文件，也不会识别项目下的 lock 文件，所以还是推荐使用 npm 或者其他包管理工具，通过绑定镜像源的方式来管理你项目的包。</p></div><h3 id="通过-yarn-安装" tabindex="-1"><a class="header-anchor" href="#通过-yarn-安装" aria-hidden="true">#</a> 通过 yarn 安装</h3><p><a href="https://github.com/yarnpkg/yarn" target="_blank" rel="noopener noreferrer">yarn<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 也是一个常用的包管理工具，和 npm 十分相似， npmjs 上的包，也会同步到 <a href="https://yarnpkg.com/" target="_blank" rel="noopener noreferrer">yarnpkg<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 。</p><p>也是需要全局安装才可以使用：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> -g <span class="token function">yarn</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>但是安装命令上会有点不同， yarn 是用 <code>add</code> 代替 <code>install</code> ，用 <code>remove</code> 代替 <code>uninstall</code> ，例如：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 安装单个包</span>
<span class="token function">yarn</span> <span class="token function">add</span> vue-router

<span class="token comment"># 安装全局包</span>
<span class="token function">yarn</span> global <span class="token function">add</span> typescript

<span class="token comment"># 卸载包</span>
<span class="token function">yarn</span> remove vue-router
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>而且在运行脚本的时候，可以直接用 <code>yarn</code> 来代替 <code>npm run</code> ，例如 <code>yarn dev</code> 相当于 <code>npm run dev</code> 。</p><p>yarn 默认绑定的是 <code>https://registry.yarnpkg.com</code> 的下载源，如果包的下载速度太慢，也可以配置镜像源，但是命令有所差异：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 查看镜像源</span>
<span class="token function">yarn</span> config get registry

<span class="token comment"># 绑定镜像源</span>
<span class="token function">yarn</span> config <span class="token builtin class-name">set</span> registry https://registry.npmmirror.com

<span class="token comment"># 删除镜像源（注意这里是 delete ）</span>
<span class="token function">yarn</span> config delete registry
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>yarn 的 lock 文件是 <code>yarn.lock</code> ，如果你有管理多人协作仓库的需求，可以根据实际情况把它添加至 <code>.gitignore</code> 文件，便于统一团队的包管理。</p></div><h3 id="通过-pnpm-安装" tabindex="-1"><a class="header-anchor" href="#通过-pnpm-安装" aria-hidden="true">#</a> 通过 pnpm 安装</h3><p><a href="https://github.com/pnpm/pnpm" target="_blank" rel="noopener noreferrer">pnpm<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 是包管理工具的一个后起之秀，主打快速的、节省磁盘空间的特色，用法跟其他包管理器很相似，没有太多的学习成本， npm 和 yarn 的命令它都支持。</p><p>也是必须先全局安装它才可以使用：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> -g <span class="token function">pnpm</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>目前 pnpm 在开源社区的使用率越来越高，包括我们接触最多的 Vue / Vite 团队也在逐步迁移到 pnpm 来管理依赖。</p><p>pnpm 的下载源使用的是 npm ，所以如果要绑定镜像源，按照 <a href="#%E9%80%9A%E8%BF%87-npm-%E5%AE%89%E8%A3%85">npm 的方式</a> 处理就可以了。</p><p>相关阅读：</p><ul><li><a href="https://pnpm.io/zh/" target="_blank" rel="noopener noreferrer">pnpm 官网<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://pnpm.io/zh/motivation" target="_blank" rel="noopener noreferrer">为什么要使用 pnpm<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://zhuanlan.zhihu.com/p/441547677" target="_blank" rel="noopener noreferrer">为什么 vue 源码以及生态仓库要迁移 pnpm?<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://zhuanlan.zhihu.com/p/377593512" target="_blank" rel="noopener noreferrer">关于现代包管理器的深度思考——为什么现在我更推荐 pnpm 而不是 npm/yarn?<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>pnpm 的 lock 文件是 <code>pnpm-lock.yaml</code> ，如果你有管理多人协作仓库的需求，可以根据实际情况把它添加至 <code>.gitignore</code> 文件，便于统一团队的包管理。</p></div><h3 id="通过-cdn-安装" tabindex="-1"><a class="header-anchor" href="#通过-cdn-安装" aria-hidden="true">#</a> 通过 CDN 安装</h3><p>大部分插件都会提供一个 CDN 版本，让你可以在 <code>.html</code> 文件里通过 <code>&lt;script&gt;</code> 标签引入。</p><p>比如：</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://unpkg.com/vue-router<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="插件的引入" tabindex="-1"><a class="header-anchor" href="#插件的引入" aria-hidden="true">#</a> 插件的引入</h3><p>除了 CDN 版本是直接可用之外，其他通过 npm 、 yarn 等方式安装的插件，都需要在入口文件 <code>main.js</code> 或者要用到的 <code>.vue</code> 文件里引入，比如：</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createRouter<span class="token punctuation">,</span> createWebHistory<span class="token punctuation">,</span> RouteRecordRaw <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue-router&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>因为本教程都是基于工程化开发，使用的 CLI 脚手架，所以这些内容暂时不谈及 CDN 的使用方式。</p><p>通常来说会有细微差别，但影响不大，插件作者也会在插件仓库的 README 或者使用文档里进行告知。</p><h2 id="vue-专属插件" tabindex="-1"><a class="header-anchor" href="#vue-专属插件" aria-hidden="true">#</a> Vue 专属插件</h2><p>这里特指 Vue 插件，通过 <a href="https://v3.cn.vuejs.org/guide/plugins.html" target="_blank" rel="noopener noreferrer">Vue Plugins 设计规范<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 开发出来的插件，在npm上通常是以 <code>vue-xxx</code> 这样带有 vue 关键字的格式命名（比如 <a href="https://github.com/chengpeiquan/vue-baidu-analytics" target="_blank" rel="noopener noreferrer">vue-baidu-analytics<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>）。</p><p>专属插件通常分为 <strong>全局插件</strong> 和 <strong>单组件插件</strong>，区别在于，全局版本是在 <code>main.ts</code> 引入后 <code>use</code>，而单组件版本则通常是作为一个组件在 <code>.vue</code> 文件里引入使用。</p><h3 id="全局插件的使用-new" tabindex="-1"><a class="header-anchor" href="#全局插件的使用-new" aria-hidden="true">#</a> 全局插件的使用{new}</h3><p>在本教程最最前面的时候，我有特地说了一个内容就是 <a href="/update.html#%E9%A1%B9%E7%9B%AE%E5%88%9D%E5%A7%8B%E5%8C%96" class="">项目初始化 - 升级与配置</a> ，在这里有提到过就是需要通过 <code>use</code> 来初始化框架、插件。</p><p>全局插件的使用，就是在 <code>main.ts</code> 通过 <code>import</code> 引入，然后通过 <code>use</code> 来启动初始化。</p><p>在 2.x ，全局插件是通过 <code>Vue.use(xxxxxx)</code> 来启动，而现在，则需要通过 <code>createApp</code> 的 <code>use</code>，<code>use</code> 方法，既可以单独一行一个 use ，也可以直接链式 use 下去。</p><p><strong>参数</strong></p><p><code>use</code> 方法支持两个参数：</p><table><thead><tr><th style="text-align:left;">参数</th><th style="text-align:left;">类型</th><th style="text-align:left;">作用</th></tr></thead><tbody><tr><td style="text-align:left;">plugin</td><td style="text-align:left;">object | function</td><td style="text-align:left;">插件，一般是你在 import 时使用的名称</td></tr><tr><td style="text-align:left;">options</td><td style="text-align:left;">object</td><td style="text-align:left;">插件的参数，有些插件在初始化时可以配置一定的选项</td></tr></tbody></table><p>基本的写法就是像下面这样：</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// main.ts</span>
<span class="token keyword">import</span> plugin1 <span class="token keyword">from</span> <span class="token string">&#39;plugin1&#39;</span>
<span class="token keyword">import</span> plugin2 <span class="token keyword">from</span> <span class="token string">&#39;plugin2&#39;</span>
<span class="token keyword">import</span> plugin3 <span class="token keyword">from</span> <span class="token string">&#39;plugin3&#39;</span>
<span class="token keyword">import</span> plugin4 <span class="token keyword">from</span> <span class="token string">&#39;plugin4&#39;</span>

<span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>plugin1<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>plugin2<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>plugin3<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token comment">// plugin3&#39;s options</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>plugin4<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">&#39;#app&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>大部分插件到这里就可以直接启动了，个别插件可能需要通过插件 API 去手动触发，在 <code>npm package</code> 的详情页上，作者一般会告知使用方法，按照说明书操作即可。</p><h3 id="单组件插件的使用-new" tabindex="-1"><a class="header-anchor" href="#单组件插件的使用-new" aria-hidden="true">#</a> 单组件插件的使用{new}</h3><p>单组件的插件，通常自己本身也是一个 Vue 组件（大部分情况下都会打包为 JS 文件，但本质上是一个 Vue 的 component ）。</p><p>单组件的引入，一般都是在需要用到的 <code>.vue</code> 文件里单独 <code>import</code> ，然后挂到 <code>template</code> 里去渲染。</p><p>我放一个我之前打包的单组件插件 <a href="https://github.com/chengpeiquan/vue-picture-cropper" target="_blank" rel="noopener noreferrer">vue-picture-cropper<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 做案例，理解起来会比较直观：</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 放置组件的渲染标签，用于显示组件 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>vue-picture-cropper</span>
    <span class="token attr-name">:boxStyle</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{
      width: <span class="token punctuation">&#39;</span>100%<span class="token punctuation">&#39;</span>,
      height: <span class="token punctuation">&#39;</span>100%<span class="token punctuation">&#39;</span>,
      backgroundColor: <span class="token punctuation">&#39;</span>#f8f8f8<span class="token punctuation">&#39;</span>,
      margin: <span class="token punctuation">&#39;</span>auto<span class="token punctuation">&#39;</span>
    }<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">:img</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pic<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">:options</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{
      viewMode: 1,
      dragMode: <span class="token punctuation">&#39;</span>crop<span class="token punctuation">&#39;</span>,
      aspectRatio: 16 / 9,
    }<span class="token punctuation">&quot;</span></span>
  <span class="token punctuation">/&gt;</span></span>
  <span class="token comment">&lt;!-- 放置组件的渲染标签，用于显示组件 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineComponent<span class="token punctuation">,</span> onMounted<span class="token punctuation">,</span> ref <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>

<span class="token comment">// 引入单组件插件</span>
<span class="token keyword">import</span> VuePictureCropper<span class="token punctuation">,</span> <span class="token punctuation">{</span> cropper <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue-picture-cropper&#39;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// 挂载组件模板</span>
  <span class="token literal-property property">components</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    VuePictureCropper
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// 在这里定义一些组件需要用到的数据和函数</span>
  <span class="token function">setup</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> pic <span class="token operator">=</span> ref<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">onMounted</span><span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      pic<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;@/assets/logo.png&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      pic
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><p>哈哈哈哈参考上面的代码，还有注释，应该能大概了解如何使用单组件插件了吧！</p><h2 id="通用-js-ts-插件" tabindex="-1"><a class="header-anchor" href="#通用-js-ts-插件" aria-hidden="true">#</a> 通用 JS / TS 插件</h2><p>也叫普通插件，这个 “普通” 不是指功能平平无奇，而是指它们无需任何框架依赖，可以应用在任意项目中，属于独立的 Library ，比如 <a href="https://github.com/axios/axios" target="_blank" rel="noopener noreferrer">axios<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 、 <a href="https://github.com/soldair/node-qrcode" target="_blank" rel="noopener noreferrer">qrcode<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 、<a href="https://github.com/pvorb/node-md5" target="_blank" rel="noopener noreferrer">md5<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 等等，在任何技术栈都可以单独引入使用，非 Vue 专属。</p><p>通用插件的使用非常灵活，既可以全局挂载，也可以在需要用到的组件里单独引入。</p><p>组件里单独引入方式：</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> defineComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">import</span> md5 <span class="token keyword">from</span> <span class="token string">&#39;md5&#39;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">setup</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> md5Msg<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token string">&#39;message&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>全局挂载方法比较特殊，因为插件本身不是专属 Vue，没有 <code>install</code> 接口，无法通过 <code>use</code> 方法直接启动，下面有一小节内容单独讲这一块的操作，详见 <a href="#%E5%85%A8%E5%B1%80-api-%E6%8C%82%E8%BD%BD">全局 API 挂载</a>。</p><h2 id="本地插件-new" tabindex="-1"><a class="header-anchor" href="#本地插件-new" aria-hidden="true">#</a> 本地插件{new}</h2><p>插件也不全是来自于网上，有时候针对自己的业务，涉及到一些经常用到的功能模块，你也可以抽离出来封装成项目专用的插件。</p><h3 id="封装的目的" tabindex="-1"><a class="header-anchor" href="#封装的目的" aria-hidden="true">#</a> 封装的目的</h3><p>举个例子，比如在做一个具备用户系统的网站时，会涉及到手机短信验证码模块，你在开始写代码之前，需要先要考虑到这些问题：</p><ol><li><p>很多操作都涉及到下发验证码的请求，比如 “登录” 、 “注册” 、 “修改手机绑定” 、 “支付验证” 等等，代码雷同，只是接口 URL 或者参数不太一样</p></li><li><p>都是需要对手机号是否有传入、手机号的格式正确性验证等一些判断</p></li><li><p>需要对接口请求成功和失败的情况做一些不同的数据返回，但要处理的数据很相似，都是用于告知调用方当前是什么情况</p></li><li><p>返回一些 Toast 告知用户当前的交互结果</p></li></ol><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>如果不把这一块的业务代码抽离出来，你需要在每个用到的地方都写一次，不仅繁琐，而且以后一旦产品需求有改动，维护起来就惨了。</p></div><h3 id="常用的封装类型" tabindex="-1"><a class="header-anchor" href="#常用的封装类型" aria-hidden="true">#</a> 常用的封装类型</h3><p>常用的本地封装方式有两种：一种是以 <a href="#%E9%80%9A%E7%94%A8-js-ts-%E6%8F%92%E4%BB%B6">通用 JS / TS 插件</a> 的形式，一种是以 <a href="#vue-%E4%B8%93%E5%B1%9E%E6%8F%92%E4%BB%B6">Vue 专属插件</a> 的形式。</p><p>关于这两者的区别已经在对应的小节有所介绍，接下来我们来看看如何封装它们。</p><h3 id="开发本地通用-js-ts-插件" tabindex="-1"><a class="header-anchor" href="#开发本地通用-js-ts-插件" aria-hidden="true">#</a> 开发本地通用 JS / TS 插件</h3><p>一般情况下会以通用类型比较常见，因为大部分都是一些比较小的功能，而且可以很方便的在不同项目之间进行复用。</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>注：接下来会统一称之为 “通用插件” ，不论是基于 JavaScript 编写的还是 TypeScript 编写的。</p></div><h4 id="项目结构" tabindex="-1"><a class="header-anchor" href="#项目结构" aria-hidden="true">#</a> 项目结构</h4><p>通常会把这一类文件都归类在 <code>src</code> 目录下的 <code>libs</code> 文件夹里，代表存放的是 Library 文件（ JS 项目以 <code>.js</code> 文件存放， TS 项目以 <code>.ts</code> 文件存放）。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>vue-demo
│ <span class="token comment"># 源码文件夹</span>
├─src
│ │ <span class="token comment"># 本地通用插件</span>
│ └─libs
│   ├─foo.ts
│   └─bar.ts
│
│ <span class="token comment"># 其他结构这里省略…</span>
│
└─package.json
</code></pre><div class="highlight-lines"><br><br><br><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>这样在调用的时候，可以通过 <code>@/libs/foo</code> 来引入，或者你配置了 alias 别名，也可以使用别名导入，例如 <code>@libs/foo</code> 。</p><h4 id="设计规范与开发案例" tabindex="-1"><a class="header-anchor" href="#设计规范与开发案例" aria-hidden="true">#</a> 设计规范与开发案例</h4><p>在设计本地通用插件的时候，我们需要遵循 <a href="#%E7%94%A8-es-module-%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%9D%97">ES Module 模块设计规范</a> ，并且做好必要的代码注释（用途、入参、返回值等）。</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>如果还没有了解过 “模块” 的概念的话，可以先阅读 <a href="/guide.html#%E4%BA%86%E8%A7%A3%E6%A8%A1%E5%9D%97%E5%8C%96%E8%AE%BE%E8%AE%A1" class="">了解模块化设计</a> 一节的内容。</p></div><p>一般来说，会有以下三种情况需要考虑。</p><h5 id="只有一个默认功能" tabindex="-1"><a class="header-anchor" href="#只有一个默认功能" aria-hidden="true">#</a> 只有一个默认功能</h5><p>如果只有一个默认的功能，那么可以使用 <code>export default</code> 来默认导出一个函数。</p><p>例如我们需要封装一个打招呼的功能：</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// src/libs/greet.ts</span>

<span class="token doc-comment comment">/**
 * 向对方打招呼
 * <span class="token keyword">@param</span> <span class="token parameter">name</span> - 打招呼的目标人名
 * <span class="token keyword">@returns</span> 向传进来的人名返回一句欢迎语
 */</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">greet</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Welcome, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!</span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>在 Vue 组件里就可以这样使用：</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token comment">// 导入本地插件</span>
<span class="token keyword">import</span> greet <span class="token keyword">from</span> <span class="token string">&#39;@libs/greet&#39;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 导入的名称就是这个工具的方法名，可以直接调用</span>
    <span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token function">greet</span><span class="token punctuation">(</span><span class="token string">&#39;Petter&#39;</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span> <span class="token comment">// Welcome, Petter!</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="highlight-lines"><br><br><div class="highlight-line"> </div><div class="highlight-line"> </div><br><br><br><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><br><br><br></div><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h5 id="是一个小工具合集" tabindex="-1"><a class="header-anchor" href="#是一个小工具合集" aria-hidden="true">#</a> 是一个小工具合集</h5><p>如果有很多个作用相似的函数，那么建议放在一个文件里作为一个工具合集统一管理，使用 <code>export</code> 来导出里面的每个函数。</p><p>例如我们需要封装几个通过 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Regular_Expressions" target="_blank" rel="noopener noreferrer">正则表达式<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 判断表单的输入内容是否符合要求的函数：</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// src/libs/regexp.ts</span>

<span class="token doc-comment comment">/**
 * 手机号校验
 * <span class="token keyword">@param</span> <span class="token parameter">phoneNumber</span> - 手机号
 * <span class="token keyword">@returns</span> true=是手机号，false=不是手机号
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">isMob</span><span class="token punctuation">(</span>phoneNumber<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^1[3456789]\d{9}$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token function">String</span><span class="token punctuation">(</span>phoneNumber<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * 邮箱校验
 * <span class="token keyword">@param</span> <span class="token parameter">email</span> - 邮箱地址
 * <span class="token keyword">@returns</span> true=是邮箱地址，false=不是邮箱地址
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">isEmail</span><span class="token punctuation">(</span>email<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^[A-Za-z\d]+([-_.][A-Za-z\d]+)*@([A-Za-z\d]+[-.])+[A-Za-z\d]{2,4}$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>
    email
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>在 Vue 组件里就可以这样使用：</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token comment">// 需要用花括号 {} 来按照命名导出时的名称导入</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> isMob<span class="token punctuation">,</span> isEmail <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@libs/regexp&#39;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 判断是否是手机号</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isMob</span><span class="token punctuation">(</span><span class="token string">&#39;13800138000&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isMob</span><span class="token punctuation">(</span><span class="token string">&#39;123456&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// false</span>

    <span class="token comment">// 判断是否是邮箱地址</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isEmail</span><span class="token punctuation">(</span><span class="token string">&#39;example@example.com&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isEmail</span><span class="token punctuation">(</span><span class="token string">&#39;example&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="highlight-lines"><br><br><div class="highlight-line"> </div><div class="highlight-line"> </div><br><br><br><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><br><br><br></div><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>类似这种情况，就没有必要为 <code>isMob</code> 、 <code>isEmail</code> 每个方法都单独保存一个文件了，只需要统一放在 <code>regexp.ts</code> 正则文件里维护。</p></div><h5 id="包含工具及辅助函数" tabindex="-1"><a class="header-anchor" href="#包含工具及辅助函数" aria-hidden="true">#</a> 包含工具及辅助函数</h5><p>如果主要提供一个独立功能，但还需要提供一些额外的变量或者辅助函数用于特殊的业务场景，那么可以用 <code>export default</code> 导出主功能，用 <code>export</code> 导出其他变量或者辅助函数。</p><p>我们在 <a href="#%E5%8F%AA%E6%9C%89%E4%B8%80%E4%B8%AA%E9%BB%98%E8%AE%A4%E5%8A%9F%E8%83%BD">只有一个默认功能</a> 这个打招呼例子的基础上修改一下，默认提供的是 “打招呼” 的功能，偶尔需要更热情的赞美一下，那么这个 “赞美” 行为就可以用这个方式来放到这个文件里一起维护。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// src/libs/greet.ts</span>

<span class="token doc-comment comment">/**
 * 称赞对方
 * <span class="token keyword">@param</span> <span class="token parameter">name</span> - 要称赞的目标人名
 * <span class="token keyword">@returns</span> 向传进来的人名发出一句赞美的话
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">praise</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Oh! </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">! It&#39;s so kind of you!</span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * 向对方打招呼
 * <span class="token keyword">@param</span> <span class="token parameter">name</span> - 打招呼的目标人名
 * <span class="token keyword">@returns</span> 向传进来的人名发出一句欢迎语
 */</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">greet</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Welcome, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!</span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>
</code></pre><div class="highlight-lines"><br><br><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><br><br><br><br><br><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>在 Vue 组件里就可以这样使用：</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token comment">// 两者可以同时导入使用</span>
<span class="token keyword">import</span> greet<span class="token punctuation">,</span> <span class="token punctuation">{</span> praise <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@libs/greet&#39;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 使用默认的打招呼</span>
    <span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token function">greet</span><span class="token punctuation">(</span><span class="token string">&#39;Petter&#39;</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span> <span class="token comment">// Welcome, Petter!</span>

    <span class="token comment">// 使用命名导出的赞美</span>
    <span class="token keyword">const</span> praiseMessage <span class="token operator">=</span> <span class="token function">praise</span><span class="token punctuation">(</span><span class="token string">&#39;Petter&#39;</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>praiseMessage<span class="token punctuation">)</span> <span class="token comment">// Oh! Petter! It&#39;s so kind of you!</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="highlight-lines"><br><br><div class="highlight-line"> </div><div class="highlight-line"> </div><br><br><br><br><br><br><br><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><br><br><br></div><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="开发本地-vue-专属插件" tabindex="-1"><a class="header-anchor" href="#开发本地-vue-专属插件" aria-hidden="true">#</a> 开发本地 Vue 专属插件</h3><p>在 <a href="#vue-%E4%B8%93%E5%B1%9E%E6%8F%92%E4%BB%B6">Vue 专属插件</a> 部分已介绍过，这一类的插件只能给 Vue 使用，有时候自己的业务比较特殊，无法找到完全适用的 npm 包，那么就可以自己写一个！</p><h4 id="项目结构-1" tabindex="-1"><a class="header-anchor" href="#项目结构-1" aria-hidden="true">#</a> 项目结构</h4><p>通常会把这一类文件都归类在 <code>src</code> 目录下的 <code>plugins</code> 文件夹里，代表存放的是 Plugin 文件（ JS 项目以 <code>.js</code> 文件存放， TS 项目以 <code>.ts</code> 文件存放）。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>vue-demo
│ <span class="token comment"># 源码文件夹</span>
├─src
│ │ <span class="token comment"># 本地 Vue 插件</span>
│ └─plugins
│   ├─foo.ts
│   └─bar.ts
│
│ <span class="token comment"># 其他结构这里省略…</span>
│
└─package.json
</code></pre><div class="highlight-lines"><br><br><br><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>这样在调用的时候，可以通过 <code>@/plugins/foo</code> 来引入，或者你配置了 alias 别名，也可以使用别名导入，例如 <code>@plugins/foo</code> 。</p><h4 id="设计规范" tabindex="-1"><a class="header-anchor" href="#设计规范" aria-hidden="true">#</a> 设计规范</h4><p>在设计本地 Vue 插件的时候，需要遵循 Vue 官方撰写的 <a href="https://v3.cn.vuejs.org/guide/plugins.html" target="_blank" rel="noopener noreferrer">Vue Plugins 设计规范<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> ，并且做好必要的代码注释，除了标明插件 API 的 “用途、入参、返回值” 之外，最好在注释内补充一个 Example 或者 Tips 说明，功能丰富的插件最好直接写个 README 文档。</p><h4 id="开发案例" tabindex="-1"><a class="header-anchor" href="#开发案例" aria-hidden="true">#</a> 开发案例</h4><p>全局插件开发并启用后，只需要在 <code>main.ts</code> 里导入并 <code>use</code> 一次，即可在所有的组件内使用插件的功能。</p><p>下面对全局插件进行一个开发示范，希望能给大家以后需要的时候提供思路参考。</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>单组件插件一般作为 npm 包发布，会借助 Webpack 、 Vite 或者 Rollup 单独构建，本地直接放到 components 文件夹下作为组件管理即可。</p></div><h5 id="基本结构" tabindex="-1"><a class="header-anchor" href="#基本结构" aria-hidden="true">#</a> 基本结构</h5><p>插件支持导出两种格式的：一种是函数，一种是对象。</p><ol><li>当导出为一个函数时， Vue 会直接调用这个函数，此时插件内部是这样子：</li></ol><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>app<span class="token punctuation">,</span> options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 逻辑代码...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ol start="2"><li>当导出为一个对象时，对象上面需要有一个 <code>install</code> 方法给 Vue ， Vue 通过调用这个方法来启用插件，此时插件内部是这样子：</li></ol><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">install</span><span class="token operator">:</span> <span class="token punctuation">(</span>app<span class="token punctuation">,</span> options<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 逻辑代码...</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>不论哪种方式，入口函数都会接受两个入参：</p><table><thead><tr><th style="text-align:center;">参数</th><th style="text-align:center;">作用</th><th style="text-align:left;">类型</th></tr></thead><tbody><tr><td style="text-align:center;">app</td><td style="text-align:center;"><code>createApp</code> 生成的实例</td><td style="text-align:left;"><code>App</code> （从 &#39;vue&#39; 里导入该类型），见下方的案例演示</td></tr><tr><td style="text-align:center;">options</td><td style="text-align:center;">插件初始化时的选项</td><td style="text-align:left;"><code>undefined</code> 或一个对象，对象的 TS 类型由插件的选项决定</td></tr></tbody></table><p>如果需要在插件初始化时传入一些必要的选项，可以定义一个对象作为 options ，这样只要在 <code>main.ts</code> 里 <code>use</code> 插件时传入第二个参数，插件就可以拿到它们：</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// src/main.ts</span>
<span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
  <span class="token comment">// 注意这里的第二个参数就是插件选项</span>
  <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>customPlugin<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    foo<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    bar<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">&#39;#app&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="highlight-lines"><br><br><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><br></div><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h5 id="编写插件" tabindex="-1"><a class="header-anchor" href="#编写插件" aria-hidden="true">#</a> 编写插件</h5><p>这里以一个 <a href="/component.html#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8C%87%E4%BB%A4" class="">自定义指令</a> 为例，写一个用于管理自定义指令的插件，其中包含两个自定义指令：一个是判断是否有权限，一个是给文本高亮，文本高亮还支持一个插件选项。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// src/plugins/directive.ts</span>
<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> App <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>

<span class="token comment">// 插件选项的类型</span>
<span class="token keyword">interface</span> <span class="token class-name">Options</span> <span class="token punctuation">{</span>
  <span class="token comment">// 文本高亮选项</span>
  highlight<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 默认背景色</span>
    backgroundColor<span class="token operator">:</span> <span class="token builtin">string</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * 自定义指令
 * <span class="token keyword">@description</span> 保证插件单一职责，当前插件只用于添加自定义指令
 */</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">install</span><span class="token operator">:</span> <span class="token punctuation">(</span>app<span class="token operator">:</span> App<span class="token punctuation">,</span> options<span class="token operator">?</span><span class="token operator">:</span> Options<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * 权限控制
     * <span class="token keyword">@description</span> 用于在功能按钮上绑定权限，没权限时会销毁或隐藏对应 DOM 节点
     * <span class="token keyword">@tips</span> 指令传入的值是管理员的组别 id
     * <span class="token keyword">@example</span> &lt;div v-permission=&quot;1&quot; /&gt;
     */</span>
    app<span class="token punctuation">.</span><span class="token function">directive</span><span class="token punctuation">(</span><span class="token string">&#39;permission&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>el<span class="token punctuation">,</span> binding<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 假设 1 是管理员组别的 id ，则无需处理</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>binding<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span>

      <span class="token comment">// 其他情况认为没有权限，需要隐藏掉界面上的 DOM 元素</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span>parentNode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        el<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&#39;none&#39;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token doc-comment comment">/**
     * 文本高亮
     * <span class="token keyword">@description</span> 用于给指定的 DOM 节点添加背景色，搭配文本内容形成高亮效果
     * <span class="token keyword">@tips</span> 指令传入的值需要是合法的 CSS 颜色名称或者 Hex 值
     * <span class="token keyword">@example</span> &lt;div v-highlight=&quot;`cyan`&quot; /&gt;
     */</span>
    app<span class="token punctuation">.</span><span class="token function">directive</span><span class="token punctuation">(</span><span class="token string">&#39;highlight&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>el<span class="token punctuation">,</span> binding<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// 获取默认颜色</span>
      <span class="token keyword">let</span> defaultColor <span class="token operator">=</span> <span class="token string">&#39;unset&#39;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>
        Object<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&#39;[object Object]&#39;</span> <span class="token operator">&amp;&amp;</span>
        options<span class="token operator">?.</span>highlight<span class="token operator">?.</span>backgroundColor
      <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        defaultColor <span class="token operator">=</span> options<span class="token punctuation">.</span>highlight<span class="token punctuation">.</span>backgroundColor
      <span class="token punctuation">}</span>

      <span class="token comment">// 设置背景色</span>
      el<span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span>
        <span class="token keyword">typeof</span> binding<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token string">&#39;string&#39;</span> <span class="token operator">?</span> binding<span class="token punctuation">.</span>value <span class="token operator">:</span> defaultColor
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

</code></pre><div class="highlight-lines"><br><div class="highlight-line"> </div><br><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><br><br><br><br><br><br><div class="highlight-line"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br></div></div><h5 id="启用插件" tabindex="-1"><a class="header-anchor" href="#启用插件" aria-hidden="true">#</a> 启用插件</h5><p>在 <code>main.ts</code> 全局启用插件，在启用的时候我们传入了第二个参数 “插件的选项” ，这里配置了个高亮指令的默认背景颜色：</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// src/main.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">&#39;@/App.vue&#39;</span>
<span class="token keyword">import</span> directive <span class="token keyword">from</span> <span class="token string">&#39;@/plugins/directive&#39;</span> <span class="token comment">// 导入插件</span>

<span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
   <span class="token comment">// 自定义插件</span>
  <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>directive<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    highlight<span class="token operator">:</span> <span class="token punctuation">{</span>
      backgroundColor<span class="token operator">:</span> <span class="token string">&#39;#ddd&#39;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">&#39;#app&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="highlight-lines"><br><br><br><div class="highlight-line"> </div><br><br><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><div class="highlight-line"> </div><br></div><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h5 id="使用插件" tabindex="-1"><a class="header-anchor" href="#使用插件" aria-hidden="true">#</a> 使用插件</h5><p>在 Vue 组件里使用：</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 测试 permission 指令 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>根据 permission 指令的判断规则：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-permission</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>这个可以显示<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-permission</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>这个没有权限，会被隐藏<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 测试 permission 指令 --&gt;</span>

  <span class="token comment">&lt;!-- 测试 highlight 指令 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>根据 highlight 指令的判断规则：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-highlight</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>`cyan`<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>这个是青色高亮<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-highlight</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>`yellow`<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>这个是黄色高亮<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-highlight</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>`red`<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>这个是红色高亮<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-highlight</span><span class="token punctuation">&gt;</span></span>这个是使用插件初始化时设置的灰色<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 测试 highlight 指令 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="全局-api-挂载" tabindex="-1"><a class="header-anchor" href="#全局-api-挂载" aria-hidden="true">#</a> 全局 API 挂载</h2><p>对于一些使用频率比较高的插件方法，如果你觉得在每个组件里单独导入再用很麻烦，你也可以考虑将其挂载到 Vue 上，使其成为 Vue 的全局变量。</p><p><strong>注：接下来的全局变量，都是指 Vue 环境里的全局变量，非 Window 下的全局变量。</strong></p><h3 id="回顾-vue-2" tabindex="-1"><a class="header-anchor" href="#回顾-vue-2" aria-hidden="true">#</a> 回顾 Vue 2</h3><p>在 2.x ，可以通过 <code>prototype</code> 的方式来挂载全局变量，然后通过 <code>this</code> 关键字来从 Vue 原型上调用该方法。</p><p>我以 <code>md5</code> 插件为例，在 <code>main.ts</code> 里进行全局 <code>import</code>，然后通过 <code>prototype</code> 去挂到 Vue 上。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>
<span class="token keyword">import</span> md5 <span class="token keyword">from</span> <span class="token string">&#39;md5&#39;</span>

Vue<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>$md5 <span class="token operator">=</span> md5<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>之后在 <code>.vue</code> 文件里，你就可以这样去使用 <code>md5</code>。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">const</span> md5Msg<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$md5</span><span class="token punctuation">(</span><span class="token string">&#39;message&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="了解-vue-3-new" tabindex="-1"><a class="header-anchor" href="#了解-vue-3-new" aria-hidden="true">#</a> 了解 Vue 3{new}</h3><p>在 3.x ，已经不再支持 <code>prototype</code> 这样使用了，在 <code>main.ts</code> 里没有了 <code>Vue</code>，在组件的生命周期里也没有了 <code>this</code>。</p><p>如果你依然想要挂载全局变量，需要通过全新的 <a href="https://v3.cn.vuejs.org/api/application-config.html#globalproperties" target="_blank" rel="noopener noreferrer">globalProperties<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 来实现，在使用该方式之前，可以把 <code>createApp</code> 定义为一个变量再执行挂载。</p><h3 id="定义全局-api-new" tabindex="-1"><a class="header-anchor" href="#定义全局-api-new" aria-hidden="true">#</a> 定义全局 API{new}</h3><p>如上，在配置全局变量之前，你可以把初始化时的 <code>createApp</code> 定义为一个变量（假设为 <code>app</code> ），然后把需要设置为全局可用的变量或方法，挂载到 <code>app</code> 的 <code>config.globalProperties</code> 上面。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">import</span> md5 <span class="token keyword">from</span> <span class="token string">&#39;md5&#39;</span>

<span class="token comment">// 创建 Vue 实例</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>

<span class="token comment">// 把插件的 API 挂载全局变量到实例上</span>
app<span class="token punctuation">.</span>config<span class="token punctuation">.</span>globalProperties<span class="token punctuation">.</span>$md5 <span class="token operator">=</span> md5<span class="token punctuation">;</span>

<span class="token comment">// 你也可以自己写一些全局函数去挂载</span>
app<span class="token punctuation">.</span>config<span class="token punctuation">.</span>globalProperties<span class="token punctuation">.</span>$log <span class="token operator">=</span> <span class="token punctuation">(</span>text<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">&#39;#app&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="使用全局-api-new" tabindex="-1"><a class="header-anchor" href="#使用全局-api-new" aria-hidden="true">#</a> 使用全局 API{new}</h3><p>要在 Vue 组件里使用，因为 3.x 的 <a href="/component.html#%E7%BB%84%E4%BB%B6%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F-new" class="">生命周期</a> 无法取得实例的 <code>this</code> 来操作，需要通过全新的 <a href="https://v3.cn.vuejs.org/api/composition-api.html#getcurrentinstance" target="_blank" rel="noopener noreferrer">getCurrentInstance<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 组件来进行处理。</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 导入 getCurrentInstance 组件</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> defineComponent<span class="token punctuation">,</span> getCurrentInstance <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;vue&#39;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">defineComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">setup</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 获取当前实例</span>
    <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">getCurrentInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 增加这层判断的原因见下方说明</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> app <span class="token punctuation">)</span> <span class="token punctuation">{</span>

      <span class="token comment">// 调用全局的 MD5 API 进行加密</span>
      <span class="token keyword">const</span> <span class="token constant">MD5_STR</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> app<span class="token punctuation">.</span>appContext<span class="token punctuation">.</span>config<span class="token punctuation">.</span>globalProperties<span class="token punctuation">.</span><span class="token function">$md5</span><span class="token punctuation">(</span><span class="token string">&#39;Hello World!&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">MD5_STR</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token comment">// 调用刚刚挂载的打印函数</span>
      app<span class="token punctuation">.</span>appContext<span class="token punctuation">.</span>config<span class="token punctuation">.</span>globalProperties<span class="token punctuation">.</span><span class="token function">$log</span><span class="token punctuation">(</span><span class="token string">&#39;Hello World!&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>由于使用了 <a href="/component.html#%E4%BA%86%E8%A7%A3-definecomponent" class="">defineComponent</a> ，它会帮我们自动推导 <code>getCurrentInstance()</code> 的类型为 <code>ComponentInternalInstance</code> 或 <code>null</code> 。</p><p>所以如果你的项目下的 TS 开启了 <code>--strictNullChecks</code> 选项，需要对实例变量做一层判断才能正确运行程序（可参考 <a href="/component.html#dom-%E5%85%83%E7%B4%A0%E4%B8%8E%E5%AD%90%E7%BB%84%E4%BB%B6" class="">DOM 元素与子组件</a> 一节）。</p><div class="custom-container tip"><p class="custom-container-title">TIP</p><p>需要注意的是， <code>getCurrentInstance</code> 只能在 <a href="/component.html#%E5%85%A8%E6%96%B0%E7%9A%84-setup-%E5%87%BD%E6%95%B0-new" class="">setup</a> 函数或者 Vue 3.0 的 <a href="/component.html#%E7%BB%84%E4%BB%B6%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F-new" class="">生命周期</a> 钩子中调用。</p><p>如需在 <code>setup</code> 或生命周期钩子外使用，需要先在 <code>setup</code> 中调用 <code>const app = getCurrentInstance();</code> 获取实例变量，然后再通过 <code>app</code> 变量去使用。</p></div><h3 id="全局-api-的替代方案" tabindex="-1"><a class="header-anchor" href="#全局-api-的替代方案" aria-hidden="true">#</a> 全局 API 的替代方案</h3><p>在 Vue 3 实际上并不是特别推荐使用全局变量，3.x 比较推荐按需引入使用（从使用方式上也可以看得出，这类全局 API 的用法还真的挺麻烦的…）。</p><p>特别是针对 TypeScript ，尤大对于全局 API 的相关 PR 说明： <a href="https://github.com/vuejs/rfcs/pull/117" target="_blank" rel="noopener noreferrer">Global API updates<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>，也是不建议在 TS 里使用。</p><p>那么确实是需要用到一些全局 API 怎么办？</p><p>对于一般的数据和方法，建议采用 <a href="/communication.html#provide-inject" class="">provide / inject</a> 方案，在根组件（通常是 App.vue ）把需要作为全局使用的数据 / 方法 provide 下去，在需要用到的组件里通过 inject 即可获取到，或者使用 <a href="/communication.html#eventbus-new" class="">EventBus</a> 和 <a href="/communication.html#vuex-new" class="">Vuex</a> 等全局通信方案来处理。</p><h2 id="本章结语" tabindex="-1"><a class="header-anchor" href="#本章结语" aria-hidden="true">#</a> 本章结语</h2><p>插件的使用基本上就涉及到这些点了，很多同学之所以还不敢在业务中使用 Vue 3.0，应该也是顾虑于 3.0 是不是有很多插件不能用，影响业务的开发效率（之前有问过不同公司的一些朋友，大部分都是出于这个考虑）。</p><p>相信经过这一章的说明，心里应该有底了，在缺少针对性的 Vue 专属插件的情况下，不妨也试一下通用的原生 JS Library 。</p><!----><!----><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/chengpeiquan/learning-vue3/edit/main/docs/plugin.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: chengpeiquan@chengpeiquan.com">chengpeiquan</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/router.html" class="" aria-label="路由的使用"><!--[--><!--]--> 路由的使用 <!--[--><!--]--></a></span><span class="next"><a href="/communication.html" class="" aria-label="组件之间的通信"><!--[--><!--]--> 组件之间的通信 <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.0c7b3152.js" defer></script>
  </body>
</html>
